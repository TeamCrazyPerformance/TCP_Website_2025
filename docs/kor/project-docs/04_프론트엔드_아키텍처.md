# 4. 프론트엔드 아키텍처

> [← 메인 문서로 돌아가기](./README.md)

---

## 기술: Create React App 기반 React

프론트엔드는 React로 구축된 **싱글 페이지 애플리케이션 (SPA)**입니다.

## 라우팅 구조

```
/                              → 홈 페이지
/about                         → 동아리 소개
/members                       → 회원 디렉토리
/recruitment                   → 신규 회원 모집 정보
/announcement                  → 공지사항 목록
/announcement/:id              → 공지사항 상세
/study                         → 스터디 그룹 목록
/study/:id                     → 스터디 상세
/study/write                   → 스터디 생성
/team                          → 팀 모집 목록
/login                         → 로그인 페이지
/register                      → 회원가입 페이지

/mypage                        → 사용자 대시보드 (레이아웃 래퍼)
  ├── /                        → 프로필
  ├── /settings                → 일반 설정
  ├── /account-settings        → 계정 보안
  ├── /studies                 → 내 스터디
  ├── /teams                   → 내 팀
  └── /withdraw                → 계정 삭제

/admin                         → 관리자 패널 (레이아웃 래퍼)
  ├── /                        → 대시보드
  ├── /main                    → 메인 콘텐츠 관리
  ├── /recruitment             → 모집 관리
  ├── /announcement            → 공지사항 관리
  ├── /application             → 지원서 검토
  ├── /study                   → 스터디 관리
  ├── /team                    → 팀 관리
  ├── /modify-user-info        → 사용자 정보 수정
  ├── /permission              → 권한 관리
  ├── /delete-account          → 사용자 계정 삭제
  └── /server                  → 서버 모니터링
```

---

## 컴포넌트 아키텍처

### 레이아웃 컴포넌트

**Header & Footer** (`components/Header.jsx`, `components/Footer.jsx`)
- MyPage와 Admin을 제외한 모든 페이지에 표시
- Header는 스크롤 시 스타일 변경 (투명 → 단색)

**MyPageLayout** (`components/MyPageLayout.jsx`)
- 사용자 기능을 위한 사이드바 내비게이션
- 모든 `/mypage/*` 라우트에 일관된 레이아웃

**AdminLayout** (`components/AdminLayout.jsx`)
- 역할 기반 내비게이션이 있는 관리자 사이드바
- 모든 `/admin/*` 라우트에 일관된 레이아웃

---

### 재사용 가능한 컴포넌트

**UI 컴포넌트** (`components/ui/`)
- `FormInput`: 스타일이 적용된 입력 필드
- `FormTextarea`: 스타일이 적용된 텍스트 영역
- `FormSelect`: 스타일이 적용된 선택 드롭다운
- `InfoRow`: 키-값 표시 행

**모달** (`components/modals/`)
- `TeamDetailModal`: 팀 상세 보기
- `RecruitTeamModal`: 팀 모집 양식
- `RecruitStudyModal`: 스터디 모집 양식

**카드**
- `TeamCard`: 팀 모집 표시

---

## API 클라이언트

**위치**: `src/api/client.js`

**함수**:
- `apiGet(path, options)`: GET 요청
- `apiPost(path, body, options)`: POST 요청
- `apiPatch(path, body, options)`: PATCH 요청
- `apiDelete(path, options)`: DELETE 요청

**기능**:
- 자동 기본 URL 감지 (`window.location.origin`)
- JSON 콘텐츠 타입 헤더
- 설명적 메시지와 함께 오류 처리
- **자동 토큰 갱신**: 401 응답 시 자동으로 `/api/v1/auth/refresh` 호출 후 원래 요청 재시도
- **요청 큐잉**: 갱신 중 동시 실패 요청을 큐에 넣어 레이스 컨디션 방지
- **FormData 지원**: 멀티파트 파일 업로드 시 자동으로 Content-Type 헤더 제거
- **세션 만료 처리**: 복구 불가능한 인증 실패 시 localStorage 초기화 및 로그인으로 리다이렉트

**사용 예시**:
```javascript
import { apiGet, apiPost } from '../api/client';

// 공지사항 가져오기
const announcements = await apiGet('/api/announcement');

// 로그인 제출
const response = await apiPost('/api/auth/login', {
  username: 'user',
  password: 'pass123'
});
```

---

## 상태 관리

> [!NOTE]
> 애플리케이션은 전역 인증 상태에 **React Context API**를 사용하고, 로컬 컴포넌트 상태에는 **React 내장 상태 관리** (useState, useEffect)를 사용합니다. Redux나 Zustand 같은 전역 상태 라이브러리는 없습니다.

### 인증 상태 (`context/AuthContext.jsx`)

`AuthProvider`가 전체 앱을 래핑하고 `useAuth()` 훅을 통해 인증 상태를 제공합니다.

**토큰 저장**: 
- 액세스 토큰은 `localStorage`에 저장 (키: `access_token`)
- 사용자 정보는 `localStorage`에 JSON으로 저장 (키: `auth_user`)

**특징**:
- **브라우저 탭 간 동기화**: `storage` 이벤트를 리스닝하여 브라우저 탭 간 인증 상태 동기화
- **로그인 유지**: 지속 세션을 위한 선택적 `keep_logged_in` 플래그

**`useAuth()` 훅이 제공하는 것**:
- `user` — 현재 사용자 객체 (또는 null)
- `accessToken` — 현재 액세스 토큰 문자열 (또는 null)
- `isAuthenticated` — Boolean 플래그
- `login(user, accessToken, keepLoggedIn)` — 자격 증명 저장 및 상태 업데이트
- `logout()` — 백엔드 `/api/v1/auth/logout` 호출, localStorage 초기화, 상태 리셋
- `syncFromStorage()` — localStorage에서 인증 상태 재읽기

---

## 스타일링

**CSS 아키텍처**:
- `index.css`: 전역 스타일, CSS 변수, 유틸리티 클래스
- `App.css`: 컴포넌트별 스타일
- 컴포넌트별 CSS (인라인 또는 별도 파일)

**디자인 시스템** (`index.css`에서):
```css
:root {
  --primary-color: #6366f1;      /* Indigo */
  --secondary-color: #8b5cf6;    /* Purple */
  --accent-color: #f59e0b;       /* Amber */
  --background: #f9fafb;         /* Light gray */
  --text-primary: #111827;       /* Dark gray */
  --border-color: #e5e7eb;       /* Light border */
  /* ... 더 많은 변수 */
}
```

---

## 주요 기능

### 1. 스터디 그룹 관리

**사용자 여정**:
1. `/study`에서 스터디 그룹 찾아보기
2. 스터디 상세 보기 (회원, 진행 상황, 리소스)
3. 스터디 가입 (정원이 차지 않은 경우)
4. 마크다운으로 주간 진행 상황 제출
5. 스터디 리소스 업로드 (PDF, 이미지, 링크)
6. 언제든지 스터디 탈퇴

**관리자 기능**:
- 모든 스터디 생성/수정/삭제
- 모든 진행 상황 업데이트 보기
- 스터디 회원 관리

---

### 2. 팀 모집

**게시 흐름**:
1. 리더가 팀 모집 게시글 생성
2. 여러 역할 정의 (예: 프론트엔드 2명, 디자이너 1명)
3. 마감일 및 프로젝트 기간 설정
4. 프로젝트 이미지 업로드
5. 사용자가 특정 역할에 지원
6. 역할별 지원 추적
7. 역할이 채워지면 모집 마감

**지원 검토**:
- 지원자 프로필 보기
- 지원 수락/거절
- 제공된 정보로 연락

---

### 3. 회원 모집

**지원 프로세스**:
1. 지원자가 종합 이력서 작성
2. 프로젝트, 수상, 기술 스택 포함
3. 모집 기간 동안 제출
4. 관리자가 관리자 패널에서 검토
5. 코멘트와 함께 수락/거절
6. 지원자에게 결정 통지

**자동 관리**:
- 연도별로 정의된 모집 기간
- 설정에 따라 자동 열림/닫힘
- cron 작업이 10분마다 상태 업데이트

---

### 4. 프라이버시 제어

사용자가 다음 항목의 공개 여부를 제어할 수 있음:
- 이메일 주소
- GitHub 사용자명
- 기술 스택
- 학적 상태
- 포트폴리오 링크

**공개 vs. 비공개**:
- 공개: 회원 디렉토리(`/members`)에 표시
- 비공개: 사용자와 관리자에게만 표시

---

### 5. 소프트 삭제

**사용자 계정**:
- 사용자가 계정 "탈퇴" → `deleted_at` 타임스탬프 설정
- 계정은 숨겨지지만 데이터는 30일간 보존
- 정리 작업이 30일 후 영구 삭제
- 우발적 데이터 손실 방지

---

## 다음 단계

- **[5. 개발 및 배포 가이드 →](./05_개발_및_배포_가이드.md)**: 로컬 환경 설정 및 배포 방법 배우기
- **[← 3. 백엔드 아키텍처](./03_백엔드_아키텍처.md)**
- **[← 메인 문서로 돌아가기](./README.md)**

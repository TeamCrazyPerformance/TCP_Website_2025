# ğŸ› ï¸ ì„œë²„ ìš´ì˜ ê°€ì´ë“œ: ì„œë¹„ìŠ¤ë³„ ë…ë¦½ ì—…ë°ì´íŠ¸ ë°©ë²•

í˜„ì¬ ì„œë²„ëŠ” **Docker Compose**ë¥¼ ê¸°ë°˜ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆì–´, ì „ì²´ ì„œë²„ë¥¼ ë„ì§€ ì•Šê³ ë„ ê° ì„œë¹„ìŠ¤(í”„ë¡ íŠ¸ì—”ë“œ, ë°±ì—”ë“œ, DB)ë¥¼ ë…ë¦½ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ ê°€ì´ë“œëŠ” ì„œë²„ ìš´ì˜ ì¤‘ ìì£¼ ë°œìƒí•˜ëŠ” **ë¬´ì¤‘ë‹¨/ìµœì†Œ ì¤‘ë‹¨ ì—…ë°ì´íŠ¸** ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤.

---

## 1. í”„ë¡ íŠ¸ì—”ë“œ (Web) ë…ë¦½ ì—…ë°ì´íŠ¸

í”„ë¡ íŠ¸ì—”ë“œëŠ” `web/dist` í´ë”ì˜ ì •ì  íŒŒì¼ì„ Nginxê°€ ì„œë¹™í•˜ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤. ì»¨í…Œì´ë„ˆë¥¼ ì¬ì‹œì‘í•  í•„ìš” ì—†ì´, **ë¹Œë“œ ê²°ê³¼ë¬¼ë§Œ êµì²´í•˜ë©´ ì¦‰ì‹œ ë°˜ì˜**ë©ë‹ˆë‹¤.

### ì ˆì°¨
1. `CICDtools/update_frontend.sh` ì‹¤í–‰

```bash
# í•œ ë²ˆì— ì‹¤í–‰ (ìë™ ë°±ì—… í¬í•¨)
./CICDtools/update_frontend.sh
```

> **ì°¸ê³ :** ë¹Œë“œê°€ ì™„ë£Œë˜ëŠ” ì¦‰ì‹œ ì‚¬ìš©ìê°€ ìƒˆë¡œê³ ì¹¨í•˜ë©´ ë³€ê²½ ì‚¬í•­ì´ ë³´ì…ë‹ˆë‹¤.

---

## 2. ë°±ì—”ë“œ (API) ë…ë¦½ ì—…ë°ì´íŠ¸

ë°±ì—”ë“œ ì½”ë“œê°€ ë³€ê²½ë˜ì—ˆì„ ë•Œ, API ì»¨í…Œì´ë„ˆë§Œ ë‹¤ì‹œ ë¹Œë“œí•˜ê³  êµì²´í•©ë‹ˆë‹¤.

### ì ˆì°¨
1. `CICDtools/update_backend.sh` ì‹¤í–‰

```bash
# í•œ ë²ˆì— ì‹¤í–‰ (ì‹¤í–‰ ì¤‘ì¸ ì„œë¹„ìŠ¤ ì¤‘ë‹¨ ìµœì†Œí™”, ìë™ ë°±ì—… í¬í•¨)
sudo ./CICDtools/update_backend.sh
```

> **ì£¼ì˜:** API ì»¨í…Œì´ë„ˆê°€ ì¬ì‹œì‘ë˜ëŠ” ë™ì•ˆ(ì•½ 1~5ì´ˆ) API ìš”ì²­ì€ ì‹¤íŒ¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## 3. ë°ì´í„°ë² ì´ìŠ¤ (DB) ë…ë¦½ ì—…ë°ì´íŠ¸

DB ì—…ë°ì´íŠ¸ëŠ” í¬ê²Œ **ìŠ¤í‚¤ë§ˆ ë³€ê²½(Migration)**ê³¼ **DB ë²„ì „/ì„¤ì • ë³€ê²½**ìœ¼ë¡œ ë‚˜ë‰©ë‹ˆë‹¤.

### 3.1 ìŠ¤í‚¤ë§ˆ ë³€ê²½ (ì»¬ëŸ¼ ì¶”ê°€, í…Œì´ë¸” ìƒì„± ë“±)
ì„œë²„ë¥¼ ë„ì§€ ì•Šê³  ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ì‹¤í–‰í•©ë‹ˆë‹¤.

```bash
# í•œ ë²ˆì— ì‹¤í–‰ (ìë™ ë°±ì—… í¬í•¨)
sudo ./CICDtools/migrate_db.sh
```

### 3.2 DB ì„¤ì • ë³€ê²½ (ë¹„ë°€ë²ˆí˜¸, ë²„ì „ ì—…ê·¸ë ˆì´ë“œ ë“±)
`docker-compose.yml`ì´ë‚˜ `.env` íŒŒì¼ì„ìˆ˜ì •í•œ ê²½ìš°ì…ë‹ˆë‹¤.

```bash
# DB ì»¨í…Œì´ë„ˆë§Œ ì¬ìƒì„±
docker compose up -d --no-deps db
```

> **ì£¼ì˜:** DB ì»¨í…Œì´ë„ˆê°€ ì¬ì‹œì‘ë˜ëŠ” ë™ì•ˆ ë°±ì—”ë“œì—ì„œ DB ì—°ê²° ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤.

---

## 4. ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ (Nginx) ì„¤ì • ë³€ê²½

`reverse-proxy/default.conf` ë“± Nginx ì„¤ì •ì´ë‚˜ SSL ì¸ì¦ì„œë¥¼ ê°±ì‹ í–ˆì„ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.

```bash
# ì„¤ì • ë³€ê²½ í›„ Nginx ì¬ë¡œë”© (ì¤‘ë‹¨ ì—†ìŒ)
docker compose exec reverse-proxy nginx -s reload
```

---

## ìš”ì•½

| ì‘ì—… | ëª…ë ¹ì–´ | ì¤‘ë‹¨ ë²”ìœ„ |
|------|--------|-----------|
| **í”„ë¡ íŠ¸ ë°°í¬** | `cd web && npm run build` | **ë¬´ì¤‘ë‹¨** |
| **ë°±ì—”ë“œ ë°°í¬** | `docker compose build api && docker compose up -d --no-deps api` | APIë§Œ ì ì‹œ ì¤‘ë‹¨ |
| **DB ë§ˆì´ê·¸ë ˆì´ì…˜** | `docker compose exec api npm run migration:run` | **ë¬´ì¤‘ë‹¨** |
| **ì „ì²´ ì¬ì‹œì‘** | `docker compose restart` | ì „ì²´ ì¤‘ë‹¨ |
